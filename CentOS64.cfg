# Kickstart file automatically generated by anaconda.

#version=DEVEL
install
# Text mode installation
text
cdrom
#url --url=http://mirror.its.sfu.ca/mirror/CentOS/6.4/os/x86_64
lang en_US.UTF-8
keyboard us
network --onboot yes --device eth0 --bootproto dhcp --noipv6
# AKA - vagrant 
rootpw  --iscrypted $6$3klEOB55h4ewOjya$iAh7IhB1obm926LNQlyPzj9/dNlUijGLxm/i.7BtDJjySEe.VrbWX9Zj.WeRl1O9wuKjATiYRADx.8icLIbDH1
firewall --service=ssh
authconfig --enableshadow --passalgo=sha512
selinux --disabled
timezone --utc America/Vancouver
bootloader --location=mbr --driveorder=sda --append="crashkernel=auto rhgb quiet"
# The following is the partition information you requested
# Note that any partitions you deleted are not expressed
# here so unless you clear all partitions first, this is
# not guaranteed to work
zerombr
clearpart --linux --drives=sda
part /boot --fstype=ext4 --size=500
part pv.008002 --grow --size=1

volgroup vg_vangrantcentos64 --pesize=4096 pv.008002
logvol / --fstype=ext4 --name=lv_root --vgname=vg_vangrantcentos64 --grow --size=1024 --maxsize=51200
logvol swap --name=lv_swap --vgname=vg_vangrantcentos64 --grow --size=2016 --maxsize=2016

repo --name="CentOS"  --baseurl=http://mirror.its.sfu.ca/mirror/CentOS/6.4/os/x86_64 --cost=100
group --name=vagrant
user --name=vagrant --groups=vagrant --password=vagrant

reboot --eject

%packages
@core
@server-policy
@Development Tools
ruby-devel
rubygems
%end

%post
# Replace SUDOERs with this content
cat <<<EOF
echo 'Defaults   !visiblepw '> /etc/sudoers
echo 'Defaults    always_set_home' >> /etc/sudoers
echo 'Defaults    env_reset ' >> /etc/sudoers
echo 'Defaults    env_keep =  "COLORS DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS" ' >> /etc/sudoers
echo 'Defaults    env_keep += "MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE" ' >> /etc/sudoers
echo 'Defaults    env_keep += "LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES" ' >> /etc/sudoers
echo 'Defaults    env_keep += "LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE" ' >> /etc/sudoers
echo 'Defaults    env_keep += "LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY" ' >> /etc/sudoers
echo 'Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin ' >> /etc/sudoers
echo 'root	ALL=(ALL) 	ALL ' >> /etc/sudoers
echo '@vagrant	ALL:NOPASSWD	ALL ' >> /etc/sudoers
sed -i 's/timeout=.*/timeout=0/' /boot/grub/grub.conf
gem install chef puppet --no-rdoc --no-ri
rm -r "$(gem env gemdir)"/doc/*
yum clean all

%end